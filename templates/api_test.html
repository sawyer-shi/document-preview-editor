<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>APIÊé•Âè£ÊµãËØï</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            min-height: 100vh;
            padding: 20px;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .api-test-header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }
        
        .api-test-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        /* Ëã±ÊñáÊ†áÈ¢òÂ≠ó‰Ωì‰ºòÂåñ */
        .api-test-header h1.en-title {
            font-size: 2rem;
        }
        
        .back-link {
            display: inline-block;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            margin: 20px 0;
            transition: all 0.3s ease;
        }
        
        .back-link:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }
        
        .test-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .test-panel h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        .scenario-grid {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }
        
        .scenario-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .scenario-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }
        
        .scenario-card.collapsed .scenario-details {
            display: none;
        }
        
        .scenario-card.expanded .scenario-details {
            display: block;
        }
        
        .scenario-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
        }
        
        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .scenario-title {
            font-weight: 600;
            color: #495057;
            margin-bottom: 5px;
        }
        
        .scenario-desc {
            font-size: 0.9rem;
            color: #6c757d;
        }
        
        .expand-indicator {
            font-size: 1.2em;
            transition: transform 0.3s ease;
            color: #667eea;
        }
        
        .scenario-card.expanded .expand-indicator {
            transform: rotate(180deg);
        }
        
        .scenario-details {
            display: none;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e9ecef;
        }
        
        .request-info {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 12px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #495057;
        }
        
        .request-info h4 {
            margin: 0 0 8px 0;
            font-size: 14px;
            font-weight: 600;
            color: #343a40;
        }
        
        .api-url {
            background: #fff;
            border: 1px solid #ced4da;
            border-radius: 4px;
            padding: 6px 8px;
            margin: 4px 0;
            word-break: break-all;
            color: #0066cc;
            display: block;
        }
        
        .request-body {
            background: #fff;
            border: 1px solid #ced4da;
            border-radius: 4px;
            padding: 6px 8px;
            margin: 4px 0;
            white-space: pre-wrap;
            color: #28a745;
            display: block;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #495057;
        }
        
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.9rem;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .radio-group {
            display: flex;
            gap: 15px;
            margin-top: 5px;
        }
        
        .radio-group label {
            display: flex;
            align-items: center;
            margin-bottom: 0;
            cursor: pointer;
        }
        
        .radio-group input[type="radio"] {
            width: auto;
            margin-right: 5px;
        }
        
        .test-button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 15px;
        }
        
        .test-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        
        .download-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .download-btn {
            padding: 8px 16px;
            background: #28a745;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 12px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        
        .download-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }
        
        .download-btn:active {
            transform: translateY(0);
        }
        
        .result-area {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            min-height: 60px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        
        .unified-download-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .unified-download-section h2 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.5rem;
        }
        
        .unified-download-section p {
            color: #6c757d;
            margin-bottom: 20px;
        }
        
        .unified-download-section .download-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        @media (max-width: 1200px) {
            .test-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="api-test-header">
            {% if current_language == 'zh' %}
                <h1>APIÊé•Âè£ÊµãËØï</h1>
                <p>ÊñáÊ°£Â§ÑÁêÜAPIÊé•Âè£ÂäüËÉΩÊµãËØïÂπ≥Âè∞</p>
            {% else %}
                <h1 class="en-title">API Interface Testing</h1>
                <p>Document Processing API Interface Testing Platform</p>
            {% endif %}
            <a href="/" class="back-link">
                {% if current_language == 'zh' %}
                    ‚Üê ËøîÂõû‰∏ªÈ°µ
                {% else %}
                    ‚Üê Back to Main
                {% endif %}
            </a>
        </div>
        
                <!-- Áªü‰∏ÄÊµãËØïÊñá‰ª∂‰∏ãËΩΩÂå∫Âüü -->
        <div class="unified-download-section">
            {% if current_language == 'zh' %}
                <h2>üì• ÊµãËØïÊñá‰ª∂‰∏ãËΩΩ</h2>
                <p>‰∏ãËΩΩÊµãËØïÁî®ÁöÑÊ†∑‰æãÊñáÊ°£Âíå‰øÆÊîπÊù°ÁõÆÊñá‰ª∂</p>
            {% else %}
                <h2>üì• Test Files Download</h2>
                <p>Download sample documents and modification files for testing</p>
            {% endif %}
            <div class="download-buttons">
                <a href="/api/download_sample/document/{{ current_language }}" class="download-btn sample-doc-btn" onclick="preventCollapse(event)">
                    {% if current_language == 'zh' %}üìÑ Ê†∑‰æãÊñáÊ°£{% else %}üìÑ Sample Document{% endif %}
                </a>
                <a href="/api/download_sample/modifications/{{ current_language }}" class="download-btn sample-mod-btn" onclick="preventCollapse(event)">
                    {% if current_language == 'zh' %}üìù ‰øÆÊîπÊù°ÁõÆ{% else %}üìù Modifications{% endif %}
                </a>
            </div>
        </div>

<div class="test-grid">
            <!-- Ëá™Âä®Âä†ËΩΩÂú∫ÊôØÊµãËØï -->
            <div class="test-panel">
                {% if current_language == 'zh' %}
                    <h2>Ëá™Âä®Âä†ËΩΩÂú∫ÊôØÊµãËØï</h2>
                    <p>ÊµãËØïËá™Âä®Âä†ËΩΩÂäüËÉΩÔºåÊâßË°åÂêéË∑≥ËΩ¨Âà∞‰∏ªÈ°µÂä†ËΩΩÂØπÂ∫îÊï∞ÊçÆ</p>
                {% else %}
                    <h2>Auto Load Scenario Testing</h2>
                    <p>Test auto load functionality, redirect to main page after execution</p>
                {% endif %}
                
                <div class="scenario-grid">
                    <!-- Âú∫ÊôØ1: Êñá‰ª∂Âú∞ÂùÄÊµãËØï -->
                    <div class="scenario-card collapsed" onclick="toggleScenario(this, 'file_address')">
                        <div class="scenario-header">
                            <div>
                                {% if current_language == 'zh' %}
                                    <div class="scenario-title">Êñá‰ª∂Âú∞ÂùÄÊµãËØï</div>
                                    <div class="scenario-desc">ÂéüÊñá‰ª∂Âíå‰øÆÊîπÊù°ÁõÆ‰ΩøÁî®Êñá‰ª∂Âú∞ÂùÄ</div>
                                {% else %}
                                    <div class="scenario-title">File Address Test</div>
                                    <div class="scenario-desc">Use file addresses for document and modifications</div>
                                {% endif %}
                            </div>
                            <div class="expand-indicator">‚ñº</div>
                        </div>
                        
                        <div class="scenario-details">
                            <div class="request-info" id="request_info_file_address">
                                {% if current_language == 'zh' %}
                                    <h4>üì° ËØ∑Ê±Ç‰ø°ÊÅØÈ¢ÑËßà</h4>
                                    <div>APIÂú∞ÂùÄ: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>ËØ∑Ê±Ç‰Ωì: <span class="request-body">Á≠âÂæÖÂèÇÊï∞ËæìÂÖ•...</span></div>
                                {% else %}
                                    <h4>üì° Request Info Preview</h4>
                                    <div>API URL: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>Request Body: <span class="request-body">Waiting for parameters...</span></div>
                                {% endif %}
                            </div>
                            <form onsubmit="runAutoLoadTest(event, 'file_address')">
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>ÂéüÊñá‰ª∂docxÂú∞ÂùÄ</label>
                                    {% else %}
                                        <label>Original DOCX File Path</label>
                                    {% endif %}
                                    <input type="text" name="document" placeholder="sample_document.docx" value="sample_document.docx" onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>‰øÆÊîπÊù°ÁõÆÊñá‰ª∂csvÂú∞ÂùÄ</label>
                                    {% else %}
                                        <label>Modification CSV File Path</label>
                                    {% endif %}
                                    <input type="text" name="modifications" placeholder="sample_modifications.csv" value="sample_modifications.csv" onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>ËØ≠Ë®Ä</label>
                                    {% else %}
                                        <label>Language</label>
                                    {% endif %}
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="language" value="zh" {% if current_language == "zh" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}‰∏≠Êñá{% else %}Chinese{% endif %}
                                        </label>
                                        <label>
                                            <input type="radio" name="language" value="en" {% if current_language == "en" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}English{% else %}English{% endif %}
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>Ëá™Âä®Â∫îÁî®</label>
                                    {% else %}
                                        <label>Auto Apply</label>
                                    {% endif %}
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="auto_apply" value="true" onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}ÊòØ{% else %}Yes{% endif %}
                                        </label>
                                        <label>
                                            <input type="radio" name="auto_apply" value="false" checked onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}Âê¶{% else %}No{% endif %}
                                        </label>
                                    </div>
                                </div>
                                
                                {% if current_language == 'zh' %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">ËøêË°åÂπ∂Ë∑≥ËΩ¨</button>
                                {% else %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">Run and Redirect</button>
                                {% endif %}
                            </form>
                            
                            <div class="result-area" id="result_file_address">
                                {% if current_language == 'zh' %}
                                    Á≠âÂæÖÊµãËØïËøêË°å...
                                {% else %}
                                    Waiting for test to run...
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Âú∫ÊôØ2: Êñá‰ª∂ÊµÅÊµãËØï -->
                    <div class="scenario-card collapsed" onclick="toggleScenario(this, 'file_upload')">
                        <div class="scenario-header">
                            <div>
                                {% if current_language == 'zh' %}
                                    <div class="scenario-title">Êñá‰ª∂ÊµÅÊµãËØï</div>
                                    <div class="scenario-desc">‰∏ä‰º†Êú¨Âú∞ÂéüÊñá‰ª∂Âíå‰øÆÊîπÊù°ÁõÆÊñá‰ª∂</div>
                                {% else %}
                                    <div class="scenario-title">File Upload Test</div>
                                    <div class="scenario-desc">Upload local document and modification files</div>
                                {% endif %}
                            </div>
                            <div class="expand-indicator">‚ñº</div>
                        </div>
                        
                        <div class="scenario-details">
                            <div class="request-info" id="request_info_file_upload">
                                {% if current_language == 'zh' %}
                                    <h4>üì° ËØ∑Ê±Ç‰ø°ÊÅØÈ¢ÑËßà</h4>
                                    <div>APIÂú∞ÂùÄ: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>ËØ∑Ê±Ç‰Ωì: <span class="request-body">Á≠âÂæÖÂèÇÊï∞ËæìÂÖ•...</span></div>
                                {% else %}
                                    <h4>üì° Request Info Preview</h4>
                                    <div>API URL: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>Request Body: <span class="request-body">Waiting for parameters...</span></div>
                                {% endif %}
                            </div>
                            <form onsubmit="runAutoLoadTest(event, 'file_upload')">
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>‰∏ä‰º†ÂéüÊñá‰ª∂docx</label>
                                    {% else %}
                                        <label>Upload Original DOCX</label>
                                    {% endif %}
                                    <div class="custom-file-upload">
                                        <input type="file" name="document_file" id="document_file_upload_1" accept=".docx,.txt" onchange="updateFileInfoSync(this, 'document_file_info_1'); updateRequestInfo(this)" onclick="preventCollapse(event)">
                                        <label for="document_file_upload_1" class="custom-file-button" onclick="preventCollapse(event)">
                                            Choose File
                                        </label>
                                        <span class="custom-file-info no-file" id="document_file_info_1">
                                            No file chosen
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>‰∏ä‰º†‰øÆÊîπÊù°ÁõÆÊñá‰ª∂csv</label>
                                    {% else %}
                                        <label>Upload Modification CSV</label>
                                    {% endif %}
                                    <div class="custom-file-upload">
                                        <input type="file" name="modifications_file" id="modifications_file_upload_1" accept=".csv" onchange="updateFileInfoSync(this, 'modifications_file_info_1'); updateRequestInfo(this)" onclick="preventCollapse(event)">
                                        <label for="modifications_file_upload_1" class="custom-file-button" onclick="preventCollapse(event)">
                                            Choose File
                                        </label>
                                        <span class="custom-file-info no-file" id="modifications_file_info_1">
                                            No file chosen
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>ËØ≠Ë®Ä</label>
                                    {% else %}
                                        <label>Language</label>
                                    {% endif %}
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="language" value="zh" {% if current_language == "zh" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}‰∏≠Êñá{% else %}Chinese{% endif %}
                                        </label>
                                        <label>
                                            <input type="radio" name="language" value="en" {% if current_language == "en" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}English{% else %}English{% endif %}
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>Ëá™Âä®Â∫îÁî®</label>
                                    {% else %}
                                        <label>Auto Apply</label>
                                    {% endif %}
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="auto_apply" value="true" onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}ÊòØ{% else %}Yes{% endif %}
                                        </label>
                                        <label>
                                            <input type="radio" name="auto_apply" value="false" checked onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}Âê¶{% else %}No{% endif %}
                                        </label>
                                    </div>
                                </div>
                                
                                {% if current_language == 'zh' %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">ËøêË°åÂπ∂Ë∑≥ËΩ¨</button>
                                {% else %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">Run and Redirect</button>
                                {% endif %}
                            </form>
                            
                            <div class="result-area" id="result_file_upload">
                                {% if current_language == 'zh' %}
                                    Á≠âÂæÖÊµãËØïËøêË°å...
                                {% else %}
                                    Waiting for test to run...
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Âú∫ÊôØ3: Êñá‰ª∂Âú∞ÂùÄ+JSONÊµãËØï -->
                    <div class="scenario-card collapsed" onclick="toggleScenario(this, 'file_address_json')">
                        <div class="scenario-header">
                            <div>
                                {% if current_language == 'zh' %}
                                    <div class="scenario-title">Êñá‰ª∂Âú∞ÂùÄ+JSONÊµãËØï</div>
                                    <div class="scenario-desc">ÂéüÊñá‰ª∂‰ΩøÁî®Âú∞ÂùÄÔºå‰øÆÊîπÊù°ÁõÆ‰ΩøÁî®JSON</div>
                                {% else %}
                                    <div class="scenario-title">File Address + JSON Test</div>
                                    <div class="scenario-desc">Use file address for document, JSON for modifications</div>
                                {% endif %}
                            </div>
                            <div class="expand-indicator">‚ñº</div>
                        </div>
                        
                        <div class="scenario-details">
                            <div class="request-info" id="request_info_file_address_json">
                                {% if current_language == 'zh' %}
                                    <h4>üì° ËØ∑Ê±Ç‰ø°ÊÅØÈ¢ÑËßà</h4>
                                    <div>APIÂú∞ÂùÄ: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>ËØ∑Ê±Ç‰Ωì: <span class="request-body">Á≠âÂæÖÂèÇÊï∞ËæìÂÖ•...</span></div>
                                {% else %}
                                    <h4>üì° Request Info Preview</h4>
                                    <div>API URL: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>Request Body: <span class="request-body">Waiting for parameters...</span></div>
                                {% endif %}
                            </div>
                            
                            <form onsubmit="runAutoLoadTest(event, 'file_address_json')">
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>ÂéüÊñá‰ª∂docxÂú∞ÂùÄ</label>
                                    {% else %}
                                        <label>Original DOCX File Path</label>
                                    {% endif %}
                                    <input type="text" name="document" placeholder="sample_document.docx" value="sample_document.docx" onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>‰øÆÊîπÊù°ÁõÆJSONÊï∞ÁªÑ</label>
                                    {% else %}
                                        <label>Modifications JSON</label>
                                    {% endif %}
                                    {% if current_language == 'zh' %}
                                        <textarea name="modifications" placeholder='[{"original_text":"ÊóßÊñáÊú¨","new_text":"Êñ∞ÊñáÊú¨","reason":"‰øÆÊîπÂéüÂõ†"}]' onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">[{"original_text":"Document Preview Editor","new_text":"Document Preview Editor Pro","reason":"ÁâàÊú¨ÂçáÁ∫ß"},{"original_text":"Âü∫‰∫éFlaskÁöÑÊô∫ËÉΩÊñáÊ°£Â§ÑÁêÜÁ≥ªÁªü","new_text":"Âü∫‰∫éFlaskÁöÑÈ´òÁ∫ßÊô∫ËÉΩÊñáÊ°£Â§ÑÁêÜÁ≥ªÁªü","reason":"ÂäüËÉΩÂ¢ûÂº∫"},{"original_text":"ÊîØÊåÅÂ§öÁßçÊñáÊ°£Êìç‰ΩúÊ®°Âºè","new_text":"ÊîØÊåÅÂçÅÂ§öÁßçÊñáÊ°£Êìç‰ΩúÊ®°Âºè","reason":"ÂäüËÉΩÊâ©Â±ï"}]</textarea>
                                    {% else %}
                                        <textarea name="modifications" placeholder='[{"original_text":"old text","new_text":"new text","reason":"modification reason"}]' onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">[{"original_text":"Document Preview Editor","new_text":"Document Preview Editor Pro","reason":"Version upgrade"},{"original_text":"intelligent document processing system based on Flask","new_text":"advanced intelligent document processing system based on Flask","reason":"Feature enhancement"},{"original_text":"supporting multiple document operation modes","new_text":"supporting over ten document operation modes","reason":"Feature expansion"}]</textarea>
                                    {% endif %}
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>ËØ≠Ë®Ä</label>
                                    {% else %}
                                        <label>Language</label>
                                    {% endif %}
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="language" value="zh" {% if current_language == "zh" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}‰∏≠Êñá{% else %}Chinese{% endif %}
                                        </label>
                                        <label>
                                            <input type="radio" name="language" value="en" {% if current_language == "en" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}English{% else %}English{% endif %}
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>Ëá™Âä®Â∫îÁî®</label>
                                    {% else %}
                                        <label>Auto Apply</label>
                                    {% endif %}
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="auto_apply" value="true" onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}ÊòØ{% else %}Yes{% endif %}
                                        </label>
                                        <label>
                                            <input type="radio" name="auto_apply" value="false" checked onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}Âê¶{% else %}No{% endif %}
                                        </label>
                                    </div>
                                </div>
                                
                                {% if current_language == 'zh' %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">ËøêË°åÂπ∂Ë∑≥ËΩ¨</button>
                                {% else %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">Run and Redirect</button>
                                {% endif %}
                            </form>
                            
                            <div class="result-area" id="result_file_address_json">
                                {% if current_language == 'zh' %}
                                    Á≠âÂæÖÊµãËØïËøêË°å...
                                {% else %}
                                    Waiting for test to run...
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Âú∫ÊôØ4: Êñá‰ª∂ÊµÅ+JSONÊµãËØï -->
                    <div class="scenario-card collapsed" onclick="toggleScenario(this, 'file_upload_json')">
                        <div class="scenario-header">
                            <div>
                                {% if current_language == 'zh' %}
                                    <div class="scenario-title">Êñá‰ª∂ÊµÅ+JSONÊµãËØï</div>
                                    <div class="scenario-desc">‰∏ä‰º†ÂéüÊñá‰ª∂Ôºå‰øÆÊîπÊù°ÁõÆ‰ΩøÁî®JSON</div>
                                {% else %}
                                    <div class="scenario-title">File Upload + JSON Test</div>
                                    <div class="scenario-desc">Upload document file, use JSON for modifications</div>
                                {% endif %}
                            </div>
                            <div class="expand-indicator">‚ñº</div>
                        </div>
                        
                        <div class="scenario-details">
                            <div class="request-info" id="request_info_file_upload_json">
                                {% if current_language == 'zh' %}
                                    <h4>üì° ËØ∑Ê±Ç‰ø°ÊÅØÈ¢ÑËßà</h4>
                                    <div>APIÂú∞ÂùÄ: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>ËØ∑Ê±Ç‰Ωì: <span class="request-body">Á≠âÂæÖÂèÇÊï∞ËæìÂÖ•...</span></div>
                                {% else %}
                                    <h4>üì° Request Info Preview</h4>
                                    <div>API URL: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>Request Body: <span class="request-body">Waiting for parameters...</span></div>
                                {% endif %}
                            </div>
                            
                            <form onsubmit="runAutoLoadTest(event, 'file_upload_json')">
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>‰∏ä‰º†ÂéüÊñá‰ª∂docx</label>
                                    {% else %}
                                        <label>Upload Original DOCX</label>
                                    {% endif %}
                                    <div class="custom-file-upload">
                                        <input type="file" name="document_file" id="document_file_upload_2" accept=".docx,.txt" onchange="updateFileInfoSync(this, 'document_file_info_2'); updateRequestInfo(this)" onclick="preventCollapse(event)">
                                        <label for="document_file_upload_2" class="custom-file-button" onclick="preventCollapse(event)">
                                            Choose File
                                        </label>
                                        <span class="custom-file-info no-file" id="document_file_info_2">
                                            No file chosen
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>‰øÆÊîπÊù°ÁõÆJSONÊï∞ÁªÑ</label>
                                    {% else %}
                                        <label>Modifications JSON</label>
                                    {% endif %}
                                    {% if current_language == 'zh' %}
                                        <textarea name="modifications" placeholder='[{"original_text":"ÊóßÊñáÊú¨","new_text":"Êñ∞ÊñáÊú¨","reason":"‰øÆÊîπÂéüÂõ†"}]' onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">[{"original_text":"Document Preview Editor","new_text":"Document Preview Editor Pro","reason":"ÁâàÊú¨ÂçáÁ∫ß"},{"original_text":"Âü∫‰∫éFlaskÁöÑÊô∫ËÉΩÊñáÊ°£Â§ÑÁêÜÁ≥ªÁªü","new_text":"Âü∫‰∫éFlaskÁöÑÈ´òÁ∫ßÊô∫ËÉΩÊñáÊ°£Â§ÑÁêÜÁ≥ªÁªü","reason":"ÂäüËÉΩÂ¢ûÂº∫"},{"original_text":"ÊîØÊåÅÂ§öÁßçÊñáÊ°£Êìç‰ΩúÊ®°Âºè","new_text":"ÊîØÊåÅÂçÅÂ§öÁßçÊñáÊ°£Êìç‰ΩúÊ®°Âºè","reason":"ÂäüËÉΩÊâ©Â±ï"}]</textarea>
                                    {% else %}
                                        <textarea name="modifications" placeholder='[{"original_text":"old text","new_text":"new text","reason":"modification reason"}]' onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">[{"original_text":"Document Preview Editor","new_text":"Document Preview Editor Pro","reason":"Version upgrade"},{"original_text":"intelligent document processing system based on Flask","new_text":"advanced intelligent document processing system based on Flask","reason":"Feature enhancement"},{"original_text":"supporting multiple document operation modes","new_text":"supporting over ten document operation modes","reason":"Feature expansion"}]</textarea>
                                    {% endif %}
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>ËØ≠Ë®Ä</label>
                                    {% else %}
                                        <label>Language</label>
                                    {% endif %}
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="language" value="zh" {% if current_language == "zh" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}‰∏≠Êñá{% else %}Chinese{% endif %}
                                        </label>
                                        <label>
                                            <input type="radio" name="language" value="en" {% if current_language == "en" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}English{% else %}English{% endif %}
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>Ëá™Âä®Â∫îÁî®</label>
                                    {% else %}
                                        <label>Auto Apply</label>
                                    {% endif %}
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="auto_apply" value="true" onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}ÊòØ{% else %}Yes{% endif %}
                                        </label>
                                        <label>
                                            <input type="radio" name="auto_apply" value="false" checked onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}Âê¶{% else %}No{% endif %}
                                        </label>
                                    </div>
                                </div>
                                
                                {% if current_language == 'zh' %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">ËøêË°åÂπ∂Ë∑≥ËΩ¨</button>
                                {% else %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">Run and Redirect</button>
                                {% endif %}
                            </form>
                            
                            <div class="result-area" id="result_file_upload_json">
                                {% if current_language == 'zh' %}
                                    Á≠âÂæÖÊµãËØïËøêË°å...
                                {% else %}
                                    Waiting for test to run...
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Áõ¥Êé•Ëé∑ÂèñÂú∫ÊôØÊµãËØï -->
            <div class="test-panel">
                {% if current_language == 'zh' %}
                    <h2>Áõ¥Êé•Ëé∑ÂèñÂú∫ÊôØÊµãËØï</h2>
                    <p>ÊµãËØïÁõ¥Êé•Ëé∑ÂèñÂäüËÉΩÔºåÊâßË°åÂêéÁõ¥Êé•ËøîÂõûÂ§ÑÁêÜÁªìÊûú</p>
                {% else %}
                    <h2>Direct Fetch Scenario Testing</h2>
                    <p>Test direct fetch functionality, return processing results directly</p>
                {% endif %}
                
                <div class="scenario-grid">
                    <!-- Âú∫ÊôØ1: Êñá‰ª∂Âú∞ÂùÄÊµãËØï -->
                    <div class="scenario-card collapsed" onclick="toggleScenario(this, 'direct_file_address')">
                        <div class="scenario-header">
                            <div>
                                {% if current_language == 'zh' %}
                                    <div class="scenario-title">Êñá‰ª∂Âú∞ÂùÄÊµãËØï</div>
                                    <div class="scenario-desc">ÂéüÊñá‰ª∂Âíå‰øÆÊîπÊù°ÁõÆ‰ΩøÁî®Êñá‰ª∂Âú∞ÂùÄ</div>
                                {% else %}
                                    <div class="scenario-title">Direct File Address Test</div>
                                    <div class="scenario-desc">Use file addresses for document and modifications</div>
                                {% endif %}
                            </div>
                            <div class="expand-indicator">‚ñº</div>
                        </div>
                        
                        <div class="scenario-details">
                            <div class="request-info" id="request_info_direct_file_address">
                                {% if current_language == 'zh' %}
                                    <h4>üì° ËØ∑Ê±Ç‰ø°ÊÅØÈ¢ÑËßà</h4>
                                    <div>APIÂú∞ÂùÄ: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>ËØ∑Ê±Ç‰Ωì: <span class="request-body">Á≠âÂæÖÂèÇÊï∞ËæìÂÖ•...</span></div>
                                {% else %}
                                    <h4>üì° Request Info Preview</h4>
                                    <div>API URL: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>Request Body: <span class="request-body">Waiting for parameters...</span></div>
                                {% endif %}
                            </div>
                            <form onsubmit="runDirectFetchTest(event, 'direct_file_address')">
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>ÂéüÊñá‰ª∂docxÂú∞ÂùÄ</label>
                                    {% else %}
                                        <label>Original DOCX File Path</label>
                                    {% endif %}
                                    <input type="text" name="document" placeholder="sample_document.docx" value="sample_document.docx" onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>‰øÆÊîπÊù°ÁõÆÊñá‰ª∂csvÂú∞ÂùÄ</label>
                                    {% else %}
                                        <label>Modification CSV File Path</label>
                                    {% endif %}
                                    <input type="text" name="modifications" placeholder="sample_modifications.csv" value="sample_modifications.csv" onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>ËØ≠Ë®Ä</label>
                                    {% else %}
                                        <label>Language</label>
                                    {% endif %}
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="language" value="zh" {% if current_language == "zh" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}‰∏≠Êñá{% else %}Chinese{% endif %}
                                        </label>
                                        <label>
                                            <input type="radio" name="language" value="en" {% if current_language == "en" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}English{% else %}English{% endif %}
                                        </label>
                                    </div>
                                </div>
                                
                                {% if current_language == 'zh' %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">ËøêË°åÂπ∂‰∏ãËΩΩ</button>
                                {% else %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">Run and Download</button>
                                {% endif %}
                            </form>
                            
                            <div class="result-area" id="result_direct_file_address">
                                {% if current_language == 'zh' %}
                                    Á≠âÂæÖÊµãËØïËøêË°å...
                                {% else %}
                                    Waiting for test to run...
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Âú∫ÊôØ2: Êñá‰ª∂ÊµÅÊµãËØï -->
                    <div class="scenario-card collapsed" onclick="toggleScenario(this, 'direct_file_upload')">
                        <div class="scenario-header">
                            <div>
                                {% if current_language == 'zh' %}
                                    <div class="scenario-title">Êñá‰ª∂ÊµÅÊµãËØï</div>
                                    <div class="scenario-desc">‰∏ä‰º†Êú¨Âú∞ÂéüÊñá‰ª∂Âíå‰øÆÊîπÊù°ÁõÆÊñá‰ª∂</div>
                                {% else %}
                                    <div class="scenario-title">Direct File Upload Test</div>
                                    <div class="scenario-desc">Upload local document and modification files</div>
                                {% endif %}
                            </div>
                            <div class="expand-indicator">‚ñº</div>
                        </div>
                        
                        <div class="scenario-details">
                            <div class="request-info" id="request_info_direct_file_upload">
                                {% if current_language == 'zh' %}
                                    <h4>üì° ËØ∑Ê±Ç‰ø°ÊÅØÈ¢ÑËßà</h4>
                                    <div>APIÂú∞ÂùÄ: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>ËØ∑Ê±Ç‰Ωì: <span class="request-body">Á≠âÂæÖÂèÇÊï∞ËæìÂÖ•...</span></div>
                                {% else %}
                                    <h4>üì° Request Info Preview</h4>
                                    <div>API URL: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>Request Body: <span class="request-body">Waiting for parameters...</span></div>
                                {% endif %}
                            </div>
                            <form onsubmit="runDirectFetchTest(event, 'direct_file_upload')">
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>‰∏ä‰º†ÂéüÊñá‰ª∂docx</label>
                                    {% else %}
                                        <label>Upload Original DOCX</label>
                                    {% endif %}
                                    <div class="custom-file-upload">
                                        <input type="file" name="document_file" id="document_file_upload_3" accept=".docx,.txt" onchange="updateFileInfoSync(this, 'document_file_info_3'); updateRequestInfo(this)" onclick="preventCollapse(event)">
                                        <label for="document_file_upload_3" class="custom-file-button" onclick="preventCollapse(event)">
                                            Choose File
                                        </label>
                                        <span class="custom-file-info no-file" id="document_file_info_3">
                                            No file chosen
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>‰∏ä‰º†‰øÆÊîπÊù°ÁõÆÊñá‰ª∂csv</label>
                                    {% else %}
                                        <label>Upload Modification CSV</label>
                                    {% endif %}
                                    <div class="custom-file-upload">
                                        <input type="file" name="modifications_file" id="modifications_file_upload_3" accept=".csv" onchange="updateFileInfoSync(this, 'modifications_file_info_3'); updateRequestInfo(this)" onclick="preventCollapse(event)">
                                        <label for="modifications_file_upload_3" class="custom-file-button" onclick="preventCollapse(event)">
                                            Choose File
                                        </label>
                                        <span class="custom-file-info no-file" id="modifications_file_info_3">
                                            No file chosen
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>ËØ≠Ë®Ä</label>
                                    {% else %}
                                        <label>Language</label>
                                    {% endif %}
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="language" value="zh" {% if current_language == "zh" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}‰∏≠Êñá{% else %}Chinese{% endif %}
                                        </label>
                                        <label>
                                            <input type="radio" name="language" value="en" {% if current_language == "en" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}English{% else %}English{% endif %}
                                        </label>
                                    </div>
                                </div>
                                
                                {% if current_language == 'zh' %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">ËøêË°åÂπ∂‰∏ãËΩΩ</button>
                                {% else %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">Run and Download</button>
                                {% endif %}
                            </form>
                            
                            <div class="result-area" id="result_direct_file_upload">
                                {% if current_language == 'zh' %}
                                    Á≠âÂæÖÊµãËØïËøêË°å...
                                {% else %}
                                    Waiting for test to run...
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Âú∫ÊôØ3: Êñá‰ª∂Âú∞ÂùÄ+JSONÊµãËØï -->
                    <div class="scenario-card collapsed" onclick="toggleScenario(this, 'direct_file_address_json')">
                        <div class="scenario-header">
                            <div>
                                {% if current_language == 'zh' %}
                                    <div class="scenario-title">Êñá‰ª∂Âú∞ÂùÄ+JSONÊµãËØï</div>
                                    <div class="scenario-desc">ÂéüÊñá‰ª∂Áî®Âú∞ÂùÄÔºå‰øÆÊîπÊù°ÁõÆÁî®JSONÊï∞ÁªÑ</div>
                                {% else %}
                                    <div class="scenario-title">Direct File Address + JSON Test</div>
                                    <div class="scenario-desc">File address for document, JSON array for modifications</div>
                                {% endif %}
                            </div>
                            <div class="expand-indicator">‚ñº</div>
                        </div>
                        
                        <div class="scenario-details">
                            <div class="request-info" id="request_info_direct_file_address_json">
                                {% if current_language == 'zh' %}
                                    <h4>üì° ËØ∑Ê±Ç‰ø°ÊÅØÈ¢ÑËßà</h4>
                                    <div>APIÂú∞ÂùÄ: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>ËØ∑Ê±Ç‰Ωì: <span class="request-body">Á≠âÂæÖÂèÇÊï∞ËæìÂÖ•...</span></div>
                                {% else %}
                                    <h4>üì° Request Info Preview</h4>
                                    <div>API URL: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>Request Body: <span class="request-body">Waiting for parameters...</span></div>
                                {% endif %}
                            </div>
                            <form onsubmit="runDirectFetchTest(event, 'direct_file_address_json')">
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>ÂéüÊñá‰ª∂docxÂú∞ÂùÄ</label>
                                    {% else %}
                                        <label>Original DOCX File Path</label>
                                    {% endif %}
                                    <input type="text" name="document" placeholder="sample_document.docx" value="sample_document.docx" onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>‰øÆÊîπÊù°ÁõÆJSONÊï∞ÁªÑ</label>
                                    {% else %}
                                        <label>Modifications JSON</label>
                                    {% endif %}
                                    {% if current_language == 'zh' %}
                                        <textarea name="modifications" placeholder='[{"original_text":"ÊóßÊñáÊú¨","new_text":"Êñ∞ÊñáÊú¨","reason":"‰øÆÊîπÂéüÂõ†"}]' onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">[{"original_text":"Document Preview Editor","new_text":"Document Preview Editor Pro","reason":"ÁâàÊú¨ÂçáÁ∫ß"},{"original_text":"Âü∫‰∫éFlaskÁöÑÊô∫ËÉΩÊñáÊ°£Â§ÑÁêÜÁ≥ªÁªü","new_text":"Âü∫‰∫éFlaskÁöÑÈ´òÁ∫ßÊô∫ËÉΩÊñáÊ°£Â§ÑÁêÜÁ≥ªÁªü","reason":"ÂäüËÉΩÂ¢ûÂº∫"},{"original_text":"ÊîØÊåÅÂ§öÁßçÊñáÊ°£Êìç‰ΩúÊ®°Âºè","new_text":"ÊîØÊåÅÂçÅÂ§öÁßçÊñáÊ°£Êìç‰ΩúÊ®°Âºè","reason":"ÂäüËÉΩÊâ©Â±ï"}]</textarea>
                                    {% else %}
                                        <textarea name="modifications" placeholder='[{"original_text":"old text","new_text":"new text","reason":"modification reason"}]' onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">[{"original_text":"Document Preview Editor","new_text":"Document Preview Editor Pro","reason":"Version upgrade"},{"original_text":"intelligent document processing system based on Flask","new_text":"advanced intelligent document processing system based on Flask","reason":"Feature enhancement"},{"original_text":"supporting multiple document operation modes","new_text":"supporting over ten document operation modes","reason":"Feature expansion"}]</textarea>
                                    {% endif %}
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>ËØ≠Ë®Ä</label>
                                    {% else %}
                                        <label>Language</label>
                                    {% endif %}
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="language" value="zh" {% if current_language == "zh" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}‰∏≠Êñá{% else %}Chinese{% endif %}
                                        </label>
                                        <label>
                                            <input type="radio" name="language" value="en" {% if current_language == "en" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}English{% else %}English{% endif %}
                                        </label>
                                    </div>
                                </div>
                                
                                {% if current_language == 'zh' %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">ËøêË°åÂπ∂‰∏ãËΩΩ</button>
                                {% else %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">Run and Download</button>
                                {% endif %}
                            </form>
                            
                            <div class="result-area" id="result_direct_file_address_json">
                                {% if current_language == 'zh' %}
                                    Á≠âÂæÖÊµãËØïËøêË°å...
                                {% else %}
                                    Waiting for test to run...
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Âú∫ÊôØ4: Êñá‰ª∂ÊµÅ+JSONÊµãËØï -->
                    <div class="scenario-card collapsed" onclick="toggleScenario(this, 'direct_file_upload_json')">
                        <div class="scenario-header">
                            <div>
                                {% if current_language == 'zh' %}
                                    <div class="scenario-title">Êñá‰ª∂ÊµÅ+JSONÊµãËØï</div>
                                    <div class="scenario-desc">‰∏ä‰º†Êú¨Âú∞ÂéüÊñá‰ª∂Ôºå‰øÆÊîπÊù°ÁõÆÁî®JSONÊï∞ÁªÑ</div>
                                {% else %}
                                    <div class="scenario-title">Direct File Upload + JSON Test</div>
                                    <div class="scenario-desc">Upload local document, JSON array for modifications</div>
                                {% endif %}
                            </div>
                            <div class="expand-indicator">‚ñº</div>
                        </div>
                        
                        <div class="scenario-details">
                            <div class="request-info" id="request_info_direct_file_upload_json">
                                {% if current_language == 'zh' %}
                                    <h4>üì° ËØ∑Ê±Ç‰ø°ÊÅØÈ¢ÑËßà</h4>
                                    <div>APIÂú∞ÂùÄ: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>ËØ∑Ê±Ç‰Ωì: <span class="request-body">Á≠âÂæÖÂèÇÊï∞ËæìÂÖ•...</span></div>
                                {% else %}
                                    <h4>üì° Request Info Preview</h4>
                                    <div>API URL: <span class="api-url">POST /api/auto_load</span></div>
                                    <div>Request Body: <span class="request-body">Waiting for parameters...</span></div>
                                {% endif %}
                            </div>
                            <form onsubmit="runDirectFetchTest(event, 'direct_file_upload_json')">
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>‰∏ä‰º†ÂéüÊñá‰ª∂docx</label>
                                    {% else %}
                                        <label>Upload Original DOCX</label>
                                    {% endif %}
                                    <div class="custom-file-upload">
                                        <input type="file" name="document_file" id="document_file_upload_4" accept=".docx,.txt" onchange="updateFileInfoSync(this, 'document_file_info_4'); updateRequestInfo(this)" onclick="preventCollapse(event)">
                                        <label for="document_file_upload_4" class="custom-file-button" onclick="preventCollapse(event)">
                                            Choose File
                                        </label>
                                        <span class="custom-file-info no-file" id="document_file_info_4">
                                            No file chosen
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>‰øÆÊîπÊù°ÁõÆJSONÊï∞ÁªÑ</label>
                                    {% else %}
                                        <label>Modifications JSON</label>
                                    {% endif %}
                                    {% if current_language == 'zh' %}
                                        <textarea name="modifications" placeholder='[{"original_text":"ÊóßÊñáÊú¨","new_text":"Êñ∞ÊñáÊú¨","reason":"‰øÆÊîπÂéüÂõ†"}]' onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">[{"original_text":"Document Preview Editor","new_text":"Document Preview Editor Pro","reason":"ÁâàÊú¨ÂçáÁ∫ß"},{"original_text":"Âü∫‰∫éFlaskÁöÑÊô∫ËÉΩÊñáÊ°£Â§ÑÁêÜÁ≥ªÁªü","new_text":"Âü∫‰∫éFlaskÁöÑÈ´òÁ∫ßÊô∫ËÉΩÊñáÊ°£Â§ÑÁêÜÁ≥ªÁªü","reason":"ÂäüËÉΩÂ¢ûÂº∫"},{"original_text":"ÊîØÊåÅÂ§öÁßçÊñáÊ°£Êìç‰ΩúÊ®°Âºè","new_text":"ÊîØÊåÅÂçÅÂ§öÁßçÊñáÊ°£Êìç‰ΩúÊ®°Âºè","reason":"ÂäüËÉΩÊâ©Â±ï"}]</textarea>
                                    {% else %}
                                        <textarea name="modifications" placeholder='[{"original_text":"old text","new_text":"new text","reason":"modification reason"}]' onchange="updateRequestInfo(this)" oninput="updateRequestInfo(this)" onclick="preventCollapse(event)">[{"original_text":"Document Preview Editor","new_text":"Document Preview Editor Pro","reason":"Version upgrade"},{"original_text":"intelligent document processing system based on Flask","new_text":"advanced intelligent document processing system based on Flask","reason":"Feature enhancement"},{"original_text":"supporting multiple document operation modes","new_text":"supporting over ten document operation modes","reason":"Feature expansion"}]</textarea>
                                    {% endif %}
                                </div>
                                
                                <div class="form-group">
                                    {% if current_language == 'zh' %}
                                        <label>ËØ≠Ë®Ä</label>
                                    {% else %}
                                        <label>Language</label>
                                    {% endif %}
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="language" value="zh" {% if current_language == "zh" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}‰∏≠Êñá{% else %}Chinese{% endif %}
                                        </label>
                                        <label>
                                            <input type="radio" name="language" value="en" {% if current_language == "en" %}checked{% endif %} onchange="updateRequestInfo(this)">
                                            {% if current_language == 'zh' %}English{% else %}English{% endif %}
                                        </label>
                                    </div>
                                </div>
                                
                                {% if current_language == 'zh' %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">ËøêË°åÂπ∂‰∏ãËΩΩ</button>
                                {% else %}
                                    <button type="submit" class="test-button" onclick="preventCollapse(event)">Run and Download</button>
                                {% endif %}
                            </form>
                            
                            <div class="result-area" id="result_direct_file_upload_json">
                                {% if current_language == 'zh' %}
                                    Á≠âÂæÖÊµãËØïËøêË°å...
                                {% else %}
                                    Waiting for test to run...
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const API_BASE_URL = window.location.origin;
        
        // Â§öËØ≠Ë®ÄÊñáÊú¨
        const translations = {
            zh: {
                'test_running': 'Ê≠£Âú®ËøêË°åÊµãËØï...',
                'test_failed': 'ÊµãËØïÂ§±Ë¥•',
                'auto_load_test_failed': 'Ëá™Âä®Âä†ËΩΩÊµãËØïÂ§±Ë¥•',
                'direct_fetch_test_success': 'Áõ¥Êé•Ëé∑ÂèñÊµãËØïÊàêÂäü',
                'direct_fetch_test_failed': 'Áõ¥Êé•Ëé∑ÂèñÊµãËØïÂ§±Ë¥•',
                'please_select_document': 'ËØ∑ÈÄâÊã©ÊñáÊ°£Êñá‰ª∂',
                'json_format_error': 'JSONÊ†ºÂºèÈîôËØØ',
                'language_setting_failed': 'ËØ≠Ë®ÄËÆæÁΩÆÂ§±Ë¥•',
                'status': 'Áä∂ÊÄÅ',
                'processing_time': 'Â§ÑÁêÜÊó∂Èó¥',
                'file_generated': 'Êñá‰ª∂Â∑≤ÁîüÊàêÔºåÁÇπÂáª‰∏ãËΩΩÊåâÈíÆËé∑Âèñ‰øÆÊîπÂêéÁöÑÊñáÊ°£',
                'download_modified_document': '‰∏ãËΩΩ‰øÆÊîπÂêéÁöÑÊñáÊ°£',
                'processing_complete': 'Â§ÑÁêÜÂÆåÊàê',
                'no_file_chosen': 'No file chosen',
                'choose_file': 'Choose File'
            },
            en: {
                'test_running': 'Running test...',
                'test_failed': 'Test failed',
                'auto_load_test_failed': 'Auto load test failed',
                'direct_fetch_test_success': 'Direct fetch test successful',
                'direct_fetch_test_failed': 'Direct fetch test failed',
                'please_select_document': 'Please select document file',
                'json_format_error': 'JSON format error',
                'language_setting_failed': 'Language setting failed',
                'status': 'Status',
                'processing_time': 'Processing time',
                'file_generated': 'File generated, click download button to get modified document',
                'download_modified_document': 'Download modified document',
                'processing_complete': 'Processing complete',
                'no_file_chosen': 'No file chosen',
                'choose_file': 'Choose File'
            }
        };
        
        // Ëé∑ÂèñÂΩìÂâçËØ≠Ë®Ä
        let currentLanguage = '{{ current_language }}' || 'zh';
        
        function getCurrentLanguage() {
            return currentLanguage;
        }
        
        // Âä®ÊÄÅËé∑ÂèñÂΩìÂâçËØ≠Ë®ÄËÆæÁΩÆ
        async function fetchCurrentLanguage() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/get_language`);
                const data = await response.json();
                if (data.success) {
                    currentLanguage = data.language;
                    return data.language;
                }
            } catch (e) {
                console.warn('Failed to fetch current language:', e);
            }
            return currentLanguage;
        }
        
        // Ëé∑ÂèñÁøªËØëÊñáÊú¨
        function getText(key) {
            const lang = getCurrentLanguage();
            return translations[lang] && translations[lang][key] ? translations[lang][key] : translations['zh'][key] || key;
        }
        
        // Êõ¥Êñ∞Êñá‰ª∂‰ø°ÊÅØÊòæÁ§∫
        function updateFileInfo(fileInput, infoElementId) {
            const infoElement = document.getElementById(infoElementId);
            if (!infoElement) return;
            
            if (fileInput.files && fileInput.files.length > 0) {
                const fileName = fileInput.files[0].name;
                infoElement.textContent = fileName;
                infoElement.className = 'custom-file-info has-file';
            } else {
                // Êñá‰ª∂‰∏ä‰º†Êéß‰ª∂ÂßãÁªà‰ΩøÁî®Ëã±Êñá
                infoElement.textContent = 'No file chosen';
                infoElement.className = 'custom-file-info no-file';
            }
        }
        
        // ÂêåÊ≠•ÂåÖË£ÖÂáΩÊï∞ÔºåÁî®‰∫éHTML‰∫ã‰ª∂Ë∞ÉÁî®
        function updateFileInfoSync(fileInput, infoElementId) {
            updateFileInfo(fileInput, infoElementId);
        }
        
        // Êõ¥Êñ∞ÊâÄÊúâËá™ÂÆö‰πâÊñá‰ª∂‰∏ä‰º†Êéß‰ª∂ÁöÑÊñáÊú¨
        function updateCustomFileUploadTexts() {
            // Êñá‰ª∂‰∏ä‰º†Êéß‰ª∂ÂßãÁªà‰ΩøÁî®Ëã±ÊñáÔºå‰∏çÁÆ°ÂΩìÂâçËØ≠Ë®ÄÁéØÂ¢É
            console.log('Updating file upload texts to English...');
            
            // Êõ¥Êñ∞ÊâÄÊúâÊåâÈíÆÊñáÊú¨Âπ∂ÈáçÊñ∞ÁªëÂÆö‰∫ã‰ª∂
            const buttons = document.querySelectorAll('.custom-file-button');
            console.log('Found', buttons.length, 'file upload buttons');
            buttons.forEach((button, index) => {
                console.log('Updating button', index, 'from', button.textContent, 'to Choose File');
                button.textContent = 'Choose File';
                
                // ÈáçÊñ∞ÁªëÂÆöÁÇπÂáª‰∫ã‰ª∂ÔºåÁ°Æ‰øùËß¶ÂèëÊ≠£Á°ÆÁöÑÊñá‰ª∂ËæìÂÖ•Ê°Ü
                button.onclick = function(event) {
                    event.preventDefault();
                    event.stopPropagation();
                    console.log('Custom file button clicked');
                    
                    // Êü•ÊâæÂØπÂ∫îÁöÑÊñá‰ª∂ËæìÂÖ•Ê°Ü
                    const fileInput = document.querySelector(`#${this.getAttribute('for')}`);
                    if (fileInput) {
                        console.log('Triggering file input:', fileInput.id);
                        fileInput.click();
                    }
                    
                    return false;
                };
            });
            
            // Êõ¥Êñ∞ÊâÄÊúâÊñá‰ª∂‰ø°ÊÅØÊñáÊú¨ÔºàÂåÖÊã¨no-fileÂíåhas-fileÁ±ªÔºâ
            const infos = document.querySelectorAll('.custom-file-info');
            console.log('Found', infos.length, 'file info elements');
            infos.forEach((info, index) => {
                // Â¶ÇÊûúÊòØÊ≤°ÊúâÊñá‰ª∂ÈÄâÊã©ÁöÑÁä∂ÊÄÅÔºåÂº∫Âà∂ËÆæÁΩÆ‰∏∫Ëã±Êñá
                if (info.classList.contains('no-file') || !info.textContent || info.textContent.includes('Êú™ÈÄâÊã©') || info.textContent.includes('ÈÄâÊã©Êñá‰ª∂')) {
                    console.log('Updating info', index, 'from', info.textContent, 'to No file chosen');
                    info.textContent = 'No file chosen';
                    info.className = 'custom-file-info no-file';
                }
            });
            
            console.log('File upload texts update completed');
        }
        
        // ÂàáÊç¢Âú∫ÊôØÂ±ïÂºÄ/ÊäòÂè†Áä∂ÊÄÅ
        function toggleScenario(cardElement, scenarioId) {
            // ÈòªÊ≠¢‰∫ã‰ª∂ÂÜíÊ≥°
            if (event) event.stopPropagation();
            
            // ÂàáÊç¢Â±ïÂºÄ/ÊäòÂè†Áä∂ÊÄÅ
            if (cardElement.classList.contains('collapsed')) {
                // ÂÖàÊäòÂè†ÊâÄÊúâÂÖ∂‰ªñÂç°Áâá
                document.querySelectorAll('.scenario-card.expanded').forEach(card => {
                    if (card !== cardElement) {
                        card.classList.remove('expanded', 'selected');
                        card.classList.add('collapsed');
                    }
                });
                
                // Â±ïÂºÄÂΩìÂâçÂç°Áâá
                cardElement.classList.remove('collapsed');
                cardElement.classList.add('expanded', 'selected');
                
                // ÂàùÂßãÂåñËØ∑Ê±Ç‰ø°ÊÅØ
                setTimeout(() => {
                    const firstInput = cardElement.querySelector('input, textarea, select');
                    if (firstInput) {
                        updateRequestInfo(firstInput);
                    }
                }, 100);
            } else {
                // ÊäòÂè†ÂΩìÂâçÂç°Áâá
                cardElement.classList.remove('expanded', 'selected');
                cardElement.classList.add('collapsed');
            }
        }
        
        // ÈòªÊ≠¢Êñá‰ª∂ËæìÂÖ•Ê°ÜÂíå‰∏ãËΩΩÈìæÊé•ÁöÑ‰∫ã‰ª∂ÂÜíÊ≥°
        function preventCollapse(event) {
            event.stopPropagation();
        }
        
        // Êõ¥Êñ∞ËØ∑Ê±Ç‰ø°ÊÅØÊòæÁ§∫
        function updateRequestInfo(element) {
            const form = element.closest('form');
            if (!form) return;
            
            const scenarioType = form.getAttribute('onsubmit').match(/run(AutoLoad|DirectFetch)Test\(event, '([^']+)'\)/);
            if (!scenarioType) return;
            
            const scenario = scenarioType[2];
            const isDirect = scenarioType[1] === 'DirectFetch';
            
            const requestInfo = document.getElementById(`request_info_${scenario}`);
            if (!requestInfo) return;
            
            const formData = new FormData(form);
            const data = {};
            
            for (let [key, value] of formData.entries()) {
                if (key === 'document_file' || key === 'modifications_file') {
                    // Âº∫Âà∂‰ΩøÁî®Ëã±ÊñáÊñáÊú¨Ôºå‰∏çÁÆ°ËØ≠Ë®ÄÁéØÂ¢ÉÂ¶Ç‰Ωï
                    data[key] = value.name || 'No file chosen';
                } else {
                    data[key] = value;
                }
            }
            
            // ÊûÑÂª∫ÂÆåÊï¥ÁöÑAPIÂú∞ÂùÄ
            const apiEndpoint = '/api/auto_load'; // ÊâÄÊúâÂú∫ÊôØÈÉΩ‰ΩøÁî®auto_load API
            const fullApiUrl = `${API_BASE_URL}${apiEndpoint}`;
            
            let requestBody = '';
            if (scenario.includes('upload') && scenario.includes('json')) {
                // Êñá‰ª∂‰∏ä‰º†+JSONÂú∫ÊôØ
                requestBody = `FormData {\n`;
                requestBody += `  document: ${data.document_file}\n`;
                requestBody += `  modifications: JSON.stringify([...])\n`;
                requestBody += `  auto_apply: ${data.auto_apply}\n`;
                requestBody += `  language: ${data.language}\n`;
                requestBody += `}`;
            } else if (scenario.includes('json')) {
                // Á∫ØJSONÂú∫ÊôØÔºöÈúÄË¶ÅËß£ÊûêmodificationsÂ≠óÊÆµ
                const jsonData = { ...data };
                try {
                    if (data.modifications) {
                        jsonData.modifications = JSON.parse(data.modifications);
                    }
                } catch (e) {
                    jsonData.modifications = '‚ö†Ô∏è JSONÊ†ºÂºèÈîôËØØ';
                }
                requestBody = JSON.stringify(jsonData, null, 2);
            } else if (scenario.includes('upload')) {
                // Á∫ØÊñá‰ª∂‰∏ä‰º†Âú∫ÊôØ
                requestBody = `FormData {\n`;
                for (let [key, value] of Object.entries(data)) {
                    requestBody += `  ${key}: ${JSON.stringify(value)}\n`;
                }
                requestBody += `}`;
            } else {
                // Á∫ØÂú∞ÂùÄÂú∫ÊôØ
                requestBody = JSON.stringify(data, null, 2);
            }
            
            const apiUrlElement = requestInfo.querySelector('.api-url');
            const requestBodyElement = requestInfo.querySelector('.request-body');
            
            if (apiUrlElement) {
                apiUrlElement.textContent = `POST ${fullApiUrl}`;
            }
            
            if (requestBodyElement) {
                requestBodyElement.textContent = requestBody;
            }
        }
        
        // ËøêË°åËá™Âä®Âä†ËΩΩÊµãËØï
        async function runAutoLoadTest(event, scenarioType) {
            event.preventDefault();
            event.stopPropagation(); // Èò≤Ê≠¢È°µÁ≠æÊî∂Áº©
            
            const form = event.target;
            const resultArea = document.getElementById(`result_${scenarioType}`);
            
            try {
                resultArea.textContent = getText('test_running');
                resultArea.className = 'result-area';
                
                const formData = new FormData(form);
                let requestBody;
                let headers = {};
                
                // Â§ÑÁêÜ‰∏çÂêåÂú∫ÊôØÁ±ªÂûã
                if (scenarioType.includes('upload') && scenarioType.includes('json')) {
                    // Êñá‰ª∂‰∏ä‰º†+JSONÂú∫ÊôØÔºöÈúÄË¶ÅÁâπÊÆäÂ§ÑÁêÜ
                    const docFile = formData.get('document_file');
                    if (!docFile || !docFile.name) {
                        throw new Error(getText('please_select_document'));
                    }
                    
                    let modifications;
                    try {
                        modifications = JSON.parse(formData.get('modifications'));
                    } catch (e) {
                        throw new Error(getText('json_format_error') + ': ' + e.message);
                    }
                    
                    const uploadFormData = new FormData();
                    uploadFormData.append('document_file', docFile);
                    uploadFormData.append('modifications', JSON.stringify(modifications));
                    uploadFormData.append('auto_apply', formData.get('auto_apply'));
                    uploadFormData.append('language', formData.get('language'));
                    
                    requestBody = uploadFormData;
                } else if (scenarioType.includes('json')) {
                    // Á∫ØJSONÂú∫ÊôØÔºöÈúÄË¶ÅËß£ÊûêJSON
                    let modifications;
                    try {
                        modifications = JSON.parse(formData.get('modifications'));
                    } catch (e) {
                        throw new Error(getText('json_format_error') + ': ' + e.message);
                    }
                    
                    const jsonData = {
                        document: formData.get('document'),
                        modifications: modifications,
                        auto_apply: formData.get('auto_apply') === 'true',
                        language: formData.get('language')
                    };
                    
                    requestBody = JSON.stringify(jsonData);
                    headers = { 'Content-Type': 'application/json' };
                } else if (scenarioType.includes('upload')) {
                    // Á∫ØÊñá‰ª∂‰∏ä‰º†Âú∫ÊôØ
                    const docFile = formData.get('document_file');
                    const modFile = formData.get('modifications_file');
                    
                    if (!docFile || !docFile.name) {
                        throw new Error(getText('please_select_document'));
                    }
                    
                    const uploadFormData = new FormData();
                    uploadFormData.append('document_file', docFile);
                    
                    if (modFile && modFile.name) {
                        uploadFormData.append('modifications_file', modFile);
                    }
                    
                    uploadFormData.append('auto_apply', formData.get('auto_apply'));
                    uploadFormData.append('language', formData.get('language'));
                    
                    requestBody = uploadFormData;
                } else {
                    // Á∫ØÂú∞ÂùÄÂú∫ÊôØ
                    const jsonData = {
                        document: formData.get('document'),
                        modifications: formData.get('modifications'),
                        auto_apply: formData.get('auto_apply') === 'true',
                        language: formData.get('language')
                    };
                    requestBody = JSON.stringify(jsonData);
                    headers = { 'Content-Type': 'application/json' };
                }
                
                const response = await fetch(`${API_BASE_URL}/api/auto_load`, {
                    method: 'POST',
                    body: requestBody,
                    headers: headers
                });
                
                const data = await response.json();
                
                if (response.ok && data.success) {
                    // ÂÖàËÆæÁΩÆËØ≠Ë®ÄÔºåÁÑ∂ÂêéÊûÑÂª∫Ë∑≥ËΩ¨URL
                    try {
                        await fetch(`${API_BASE_URL}/api/set_language`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ language: formData.get('language') })
                        });
                    } catch (e) {
                        console.warn(getText('language_setting_failed') + ':', e);
                    }
                    
                    // ‰ΩøÁî®doc_idÁõ¥Êé•Ë∑≥ËΩ¨Âà∞‰∏ªÈ°µÔºåËøôÊ†∑ÂèØ‰ª•Áõ¥Êé•Âä†ËΩΩÂ∑≤Â§ÑÁêÜÁöÑÊñáÊ°£
                    const params = new URLSearchParams({
                        doc_id: data.doc_id,
                        from_test: 'true'
                    });
                    window.location.href = `/?${params.toString()}`;
                    return;
                } else {
                    throw new Error(data.message || getText('auto_load_test_failed'));
                }
            } catch (error) {
                resultArea.textContent = `‚ùå ${getText('test_failed')}: ${error.message}`;
                resultArea.className = 'result-area result-error';
            }
        }
        
        // ËøêË°åÁõ¥Êé•Ëé∑ÂèñÊµãËØï
        async function runDirectFetchTest(event, scenarioType) {
            event.preventDefault();
            event.stopPropagation(); // Èò≤Ê≠¢È°µÁ≠æÊî∂Áº©
            
            const form = event.target;
            const resultArea = document.getElementById(`result_${scenarioType}`);
            const startTime = Date.now(); // ËÆ∞ÂΩïÂºÄÂßãÊó∂Èó¥
            
            try {
                resultArea.textContent = getText('test_running');
                resultArea.className = 'result-area';
                
                const formData = new FormData(form);
                let requestBody;
                let headers = {};
                let apiEndpoint = '/api/auto_load'; // ÈªòËÆ§‰ΩøÁî®auto_load API
                
                // Â§ÑÁêÜ‰∏çÂêåÂú∫ÊôØÁ±ªÂûã
                if (scenarioType.includes('upload') && scenarioType.includes('json')) {
                    // Êñá‰ª∂‰∏ä‰º†+JSONÂú∫ÊôØÔºö‰ΩøÁî®auto_load API
                    const docFile = formData.get('document_file');
                    if (!docFile || !docFile.name) {
                        throw new Error(getText('please_select_document'));
                    }
                    
                    let modifications;
                    try {
                        modifications = JSON.parse(formData.get('modifications'));
                    } catch (e) {
                        throw new Error(getText('json_format_error') + ': ' + e.message);
                    }
                    
                    const uploadFormData = new FormData();
                    uploadFormData.append('document_file', docFile);
                    uploadFormData.append('modifications', JSON.stringify(modifications));
                    uploadFormData.append('language', formData.get('language'));
                    uploadFormData.append('auto_apply', 'true');
                    
                    requestBody = uploadFormData;
                    apiEndpoint = '/api/auto_load';
                } else if (scenarioType.includes('json')) {
                    // Á∫ØJSONÂú∫ÊôØÔºö‰ΩøÁî®auto_load API
                    let modifications;
                    try {
                        modifications = JSON.parse(formData.get('modifications'));
                    } catch (e) {
                        throw new Error(getText('json_format_error') + ': ' + e.message);
                    }
                    
                    const jsonData = {
                        document: formData.get('document'),
                        modifications: modifications,
                        auto_apply: true,
                        language: formData.get('language')
                    };
                    
                    requestBody = JSON.stringify(jsonData);
                    headers = { 'Content-Type': 'application/json' };
                } else if (scenarioType.includes('upload')) {
                    // Á∫ØÊñá‰ª∂‰∏ä‰º†Âú∫ÊôØÔºö‰ΩøÁî®auto_load API‰ª•Á°Æ‰øùÊ≠£Á°ÆÂ§ÑÁêÜ‰øÆÊîπ
                    const docFile = formData.get('document_file');
                    const modFile = formData.get('modifications_file');
                    
                    if (!docFile || !docFile.name) {
                        throw new Error(getText('please_select_document'));
                    }
                    
                    const uploadFormData = new FormData();
                    uploadFormData.append('document_file', docFile);
                    
                    if (modFile && modFile.name) {
                        uploadFormData.append('modifications_file', modFile);
                    }
                    
                    uploadFormData.append('auto_apply', 'true');
                    uploadFormData.append('language', formData.get('language'));
                    
                    requestBody = uploadFormData;
                    apiEndpoint = '/api/auto_load';
                } else {
                    // Á∫ØÂú∞ÂùÄÂú∫ÊôØÔºö‰ΩøÁî®auto_load API
                    const jsonData = {
                        document: formData.get('document'),
                        modifications: formData.get('modifications'),
                        auto_apply: true,
                        language: formData.get('language')
                    };
                    requestBody = JSON.stringify(jsonData);
                    headers = { 'Content-Type': 'application/json' };
                }
                
                const response = await fetch(`${API_BASE_URL}${apiEndpoint}`, {
                    method: 'POST',
                    body: requestBody,
                    headers: headers
                });
                
                const data = await response.json();
                const endTime = Date.now(); // ËÆ∞ÂΩïÁªìÊùüÊó∂Èó¥
                const processingTime = `${endTime - startTime}ms`; // ËÆ°ÁÆóÂ§ÑÁêÜÊó∂Èó¥
                
                if (response.ok && data.success) {
                    let result = `‚úÖ ${getText('direct_fetch_test_success')}\n${getText('status')}: ${response.status}\n${getText('processing_time')}: ${processingTime}\n${getText('status')}: ${data.message || getText('processing_complete')}`;
                    
                    // Â¶ÇÊûúÊúâ‰∏ãËΩΩÈìæÊé•ÔºåÊ∑ªÂä†‰∏ãËΩΩÊåâÈíÆ
                    if (data.download_url) {
                        result += `\n\nüì• ${getText('file_generated')}`;
                        resultArea.innerHTML = `<pre>${result}</pre>
<div style="margin-top: 15px;">
    <a href="${data.download_url}" download class="test-button" style="display: inline-block; text-align: center; text-decoration: none; width: auto; padding: 10px 20px;" onclick="preventCollapse(event)">
        üì• ${getText('download_modified_document')}
    </a>
</div>`;
                    } else {
                        resultArea.textContent = result;
                    }
                    resultArea.className = 'result-area result-success';
                } else {
                    throw new Error(data.message || getText('direct_fetch_test_failed'));
                }
            } catch (error) {
                resultArea.textContent = `‚ùå ${getText('test_failed')}: ${error.message}`;
                resultArea.className = 'result-area result-error';
            }
        }
        
        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            // Á°Æ‰øùÊâÄÊúâÂç°ÁâáÂàùÂßãÁä∂ÊÄÅ‰∏∫ÊäòÂè†
            document.querySelectorAll('.scenario-card').forEach(card => {
                if (!card.classList.contains('collapsed') && !card.classList.contains('expanded')) {
                    card.classList.add('collapsed');
                }
            });
            
            // Á´ãÂç≥Êõ¥Êñ∞Ëá™ÂÆö‰πâÊñá‰ª∂‰∏ä‰º†Êéß‰ª∂ÁöÑÊñáÊú¨
            updateCustomFileUploadTexts();
            
            // Âª∂ËøüÂÜçÊ¨°Êõ¥Êñ∞ÔºåÁ°Æ‰øùÊâÄÊúâÂä®ÊÄÅÂÜÖÂÆπÈÉΩÂ∑≤Âä†ËΩΩ
            setTimeout(function() {
                updateCustomFileUploadTexts();
                console.log('Secondary file upload text update completed');
            }, 500);
            
            // ‰∏∫ÊâÄÊúâÊñá‰ª∂ËæìÂÖ•Ê°ÜÊ∑ªÂä†‰∫ã‰ª∂Â§ÑÁêÜ
            document.querySelectorAll('input[type="file"]').forEach(input => {
                input.addEventListener('click', preventCollapse);
                input.addEventListener('change', preventCollapse);
            });
            
            // ‰∏∫ÊâÄÊúâË°®ÂçïÂÖÉÁ¥†Ê∑ªÂä†‰∫ã‰ª∂ÈòªÊ≠¢ÂÜíÊ≥°ÔºàÈô§‰∫ÜÊèê‰∫§ÊåâÈíÆÔºâ
            document.querySelectorAll('input, textarea, select').forEach(element => {
                if (element.type !== 'submit' && element.type !== 'button') {
                    element.addEventListener('click', preventCollapse);
                    element.addEventListener('change', preventCollapse);
                    element.addEventListener('input', preventCollapse);
                }
            });
            
            // ‰∏∫ÊâÄÊúâradioÊåâÈíÆÂíåcheckboxÊ∑ªÂä†‰∫ã‰ª∂ÈòªÊ≠¢ÂÜíÊ≥°
            document.querySelectorAll('input[type="radio"], input[type="checkbox"]').forEach(input => {
                input.addEventListener('click', preventCollapse);
                input.addEventListener('change', preventCollapse);
            });
            
            // ‰∏∫ÊµãËØïÊåâÈíÆÊ∑ªÂä†‰∫ã‰ª∂ÈòªÊ≠¢ÂÜíÊ≥°
            document.querySelectorAll('.test-button').forEach(button => {
                button.addEventListener('click', preventCollapse);
            });
            
            // ‰∏∫‰∏ãËΩΩÈìæÊé•Ê∑ªÂä†‰∫ã‰ª∂ÈòªÊ≠¢ÂÜíÊ≥°
            document.addEventListener('click', function(event) {
                if (event.target.tagName === 'A' && event.target.hasAttribute('download')) {
                    preventCollapse(event);
                }
            });
            

        });
    </script>
</body>
</html>